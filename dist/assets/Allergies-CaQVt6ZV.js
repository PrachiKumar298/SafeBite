import{u as A,r as l,R as t}from"./index-DdU1dMS1.js";import{g as N,b as h,c as S,d as v,s as C}from"./allergyService-Cag4xq3b.js";function I(){const{user:s}=A(),a=s==null?void 0:s.id,[m,p]=l.useState([]),[c,r]=l.useState(""),[y,f]=l.useState({}),[x,o]=l.useState(!0),[i,d]=l.useState(null);l.useEffect(()=>{a&&n()},[a]);const n=async()=>{o(!0);const e=await N(a);p(e);const u={};for(const g of e)u[g.allergen]=await h(a,g.allergen);f(u),o(!1)},b=async()=>{c.trim()&&(await S(a,c.trim()),r(""),await n())},w=async e=>{await v(e),await n()},E=async e=>{d(e),await C(a,e),d(null),await n()};return x?t.createElement("div",null,"Loading..."):t.createElement("div",{className:"max-w-2xl mx-auto"},t.createElement("h1",{className:"text-3xl font-bold mb-4"},"Your Allergies"),t.createElement("div",{className:"flex gap-3 mb-6"},t.createElement("input",{className:"flex-1 p-3 border rounded-lg",placeholder:"e.g., peanut, lactose, gluten",value:c,onChange:e=>r(e.target.value)}),t.createElement("button",{onClick:b,className:"px-4 py-2 bg-amber-600 text-white rounded-lg"},"Add")),t.createElement("ul",{className:"space-y-3"},m.map(e=>t.createElement("li",{key:e.id,className:"p-4 border rounded-lg bg-white flex justify-between items-center"},t.createElement("div",null,t.createElement("p",{className:"font-semibold text-lg"},e.allergen),t.createElement("p",{className:"text-gray-500 text-sm"},"Related foods:"," ",i===e.allergen?"Syncing...":y[e.allergen]??0)),t.createElement("div",{className:"flex gap-3"},t.createElement("button",{onClick:()=>E(e.allergen),className:"px-3 py-1 bg-blue-600 text-white rounded"},i===e.allergen?"Syncing...":"Rescan"),t.createElement("button",{onClick:()=>w(e.id),className:"px-3 py-1 bg-red-500 text-white rounded"},"Delete"))))))}export{I as default};
