import{u as A,r as l,R as t}from"./index-D4drG40M.js";import{g as N,b as h,c as v,d as S,s as k}from"./allergyService-CDbd7jjM.js";function I(){const{user:s}=A(),a=s==null?void 0:s.id,[m,y]=l.useState([]),[r,c]=l.useState(""),[f,b]=l.useState({}),[p,o]=l.useState(!0),[d,i]=l.useState(null);l.useEffect(()=>{a&&n()},[a]);const n=async()=>{o(!0);const e=await N(a);y(e);const u={};for(const g of e)u[g.allergen]=await h(a,g.allergen);b(u),o(!1)},x=async()=>{r.trim()&&(await v(a,r.trim()),c(""),await n())},w=async e=>{await S(e),await n()},E=async e=>{i(e),await k(a,e),i(null),await n()};return p?t.createElement("div",null,"Loading..."):t.createElement("div",{className:"max-w-2xl mx-auto"},t.createElement("h1",{className:"text-3xl font-bold mb-4"},"Your Allergies"),t.createElement("div",{className:"flex gap-3 mb-6"},t.createElement("input",{type:"text",className:"flex-1 p-3 border border-gray-300 rounded-xl bg-white text-gray-800 focus:outline-none focus:ring-2 focus:ring-green-700 focus:border-green-700",placeholder:"e.g., peanut, lactose, gluten",value:r,onChange:e=>c(e.target.value)}),t.createElement("button",{onClick:x,className:"px-4 py-2 text-white rounded-lg",style:{background:"var(--sb-accent)"}},"Add")),t.createElement("ul",{className:"space-y-3"},m.map(e=>t.createElement("li",{key:e.id,className:"p-4 border rounded-lg bg-white flex justify-between items-center"},t.createElement("div",null,t.createElement("p",{className:"font-semibold text-lg"},e.allergen),t.createElement("p",{className:"text-gray-500 text-sm"},"Related foods:"," ",d===e.allergen?"Syncing...":f[e.allergen]??0)),t.createElement("div",{className:"flex gap-3"},t.createElement("button",{onClick:()=>E(e.allergen),className:"px-3 py-1 rounded-lg border-2",style:{borderColor:"var(--sb-accent)",color:"var(--sb-accent)",background:"transparent",fontWeight:500}},d===e.allergen?"Syncing...":"Rescan"),t.createElement("button",{onClick:()=>w(e.id),className:"px-3 py-1 text-white rounded",style:{background:"var(--sb-accent)"}},"Delete"))))))}export{I as default};
