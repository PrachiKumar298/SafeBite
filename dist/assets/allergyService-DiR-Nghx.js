import{s as t}from"./index-E3EZl41n.js";const d="https://world.openfoodfacts.org/cgi/search.pl?search_terms=";async function f(o,e){const{error:r}=await t.from("allergies").insert({user_id:o,allergen:e});return r&&console.error("addAllergy error:",r),{error:r}}async function g(o){const{error:e}=await t.from("allergies").delete().eq("id",o);return e&&console.error("deleteAllergy error:",e),{error:e}}async function _(o){const{data:e,error:r}=await t.from("allergies").select("*").eq("user_id",o).order("id",{ascending:!0});return r?(console.error("getAllergies error:",r),[]):e||[]}async function p(o,e){try{const r=`${d}${encodeURIComponent(e)}&search_simple=1&action=process&json=1&page_size=200`,n=await(await fetch(r)).json(),l=((n==null?void 0:n.products)||[]).map(c=>({user_id:o,allergen:e,product_name:c.product_name||"",ingredients_text:c.ingredients_text||""}));await t.from("related_foods").delete().eq("user_id",o).eq("allergen",e);const{error:a}=await t.from("related_foods").insert(l);return a&&console.error("sync error:",a),{error:a}}catch(r){return console.error("syncAllergenProducts error:",r),{error:r}}}async function m(o,e){const{data:r,error:s}=await t.from("related_foods").select("id",{count:"exact"}).eq("user_id",o).eq("allergen",e);return s?0:r.length||0}async function y(o,e){const{data:r,error:s}=await t.from("related_foods").select("*").eq("user_id",o).eq("allergen",e);return s?[]:r}export{y as a,m as b,f as c,g as d,_ as g,p as s};
