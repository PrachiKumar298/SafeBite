import{c as v,u as N,r as i,R as e}from"./index-DdU1dMS1.js";import{g as S}from"./allergyService-Cag4xq3b.js";import{s as k}from"./savedRecipesService-OT_fr6tC.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=v("BookMarked",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["polyline",{points:"10 2 10 10 13 7 16 10 16 2",key:"13o6vz"}]]),M={peanut:["peanut","groundnut","arachis"],lactose:["milk","lactose","whey","casein","cream","yogurt"],gluten:["wheat","gluten","barley","rye"],egg:["egg","albumin","ovum"],fish:["fish","salmon","tuna","cod"],shellfish:["shrimp","prawn","lobster","crab"],soy:["soy","soya","soybean"],tree_nuts:["almond","cashew","walnut","pecan"]};function C(l=[],a=[]){const n=[];for(const m of a){const g=M[m.toLowerCase()]||[m];for(const s of l){const r=s.toLowerCase();g.some(c=>r.includes(c))&&n.push(m)}}return[...new Set(n)]}async function L(l,a){return((await(await fetch(`https://www.themealdb.com/api/json/v1/1/search.php?s=${l}`)).json()).meals||[]).map(s=>{const r=[];for(let u=1;u<=20;u++){const d=s[`strIngredient${u}`];d&&r.push(d)}const c=C(r,a);return{id:s.idMeal,title:s.strMeal,thumbnail:s.strMealThumb,safe:c.length===0,allergens:c,ingredients:r}})}function T(){const{user:l}=N(),a=l==null?void 0:l.id,[n,m]=i.useState(""),[g,s]=i.useState([]),[r,c]=i.useState([]),[u,d]=i.useState(!0),[h,p]=i.useState(!1),[y,b]=i.useState(null),E=async t=>{try{await k(a,t),alert("Recipe saved!")}catch{alert("Already saved or an error occurred.")}};i.useEffect(()=>{a&&x()},[a]);const x=async()=>{d(!0);const o=(await S(a)).map(f=>f.allergen.toLowerCase());s(o),d(!1)},w=async()=>{if(n.trim()){p(!0),b(null),c([]);try{const t=await L(n,g);c(t)}catch{b("Meal API unavailable. Try again.")}p(!1)}};return u?e.createElement("div",null,"Loading your allergies..."):e.createElement("div",{className:"max-w-4xl mx-auto"},e.createElement("h1",{className:"text-3xl font-bold mb-4"},"Meals & Restaurant Dishes"),e.createElement("p",{className:"text-gray-600 mb-6"},"Search dishes from TheMealDB and see if they're safe for your allergies."),e.createElement("div",{className:"flex gap-3 mb-6"},e.createElement("input",{className:"flex-1 p-3 border rounded-lg",placeholder:"e.g., Chicken Curry, Pasta, Salad",value:n,onChange:t=>m(t.target.value)}),e.createElement("button",{onClick:w,className:"px-4 py-2 bg-amber-600 text-white rounded-lg",disabled:h},h?"Searching...":"Search")),y&&e.createElement("div",{className:"p-4 bg-red-100 text-red-700 rounded-lg mb-4"},y),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},r.map(t=>e.createElement("div",{key:t.id,className:"bg-white p-4 rounded-xl shadow"},e.createElement("img",{src:t.thumbnail,alt:t.title,className:"rounded-lg mb-3 w-full h-48 object-cover"}),e.createElement("h2",{className:"text-xl font-semibold"},t.title),t.safe?e.createElement("p",{className:"text-green-600 font-semibold mt-1"},"SAFE ✔"):e.createElement("p",{className:"text-red-600 font-semibold mt-1"},"UNSAFE ❌"),!t.safe&&e.createElement("ul",{className:"list-disc ml-6 mt-2 text-sm text-red-600"},t.allergens.map(o=>e.createElement("li",{key:o},o))),e.createElement("div",{className:"mt-3 text-sm text-gray-700"},e.createElement("p",{className:"font-semibold"},"Ingredients:"),e.createElement("ul",{className:"list-disc ml-6"},t.ingredients.slice(0,10).map((o,f)=>e.createElement("li",{key:f},o)))),e.createElement("button",{onClick:()=>E(t),className:"mt-4 w-full flex items-center justify-center gap-2 bg-amber-500 hover:bg-amber-600 text-white py-2 rounded-lg"},e.createElement(A,{size:18})," Save Recipe")))),r.length===0&&!h&&e.createElement("p",{className:"text-gray-500 text-center mt-10"},"No meals found. Try searching something else."))}export{T as default};
